      1    00FFFE              #include "msp430.h"             ; #define
                                controlled include file
      2    00FFFE              
      3    00FFFE                      NAME    main            ; module
                                name
      4    00FFFE              
      5    000000                      PUBLIC  main            ; make the main
                                                                label
                                                                visible
      6    00FFFE                                              ; outside this
                                module
      7    00FFFE                      ORG     0FFFEh
      8    00FFFE ....                 DC16    init            ; set reset
                                                                vector to
                                                                'init'
                                                                label
      9    010000                      
     10    010000                      ; ustawienie wszystkich wektorow
                                przerwan oprocz
     11    010000                      ; Reset na domyslna obsluge
     12    00FFFC                      ORG     0FFFCh
     13    00FFFC ....                 DC16    default_int
     14    00FFFA                      ORG     0FFFAh
     15    00FFFA ....                 DC16    default_int
     16    00FFF6                      ORG     0FFF6h
     17    00FFF6 ....                 DC16    default_int
     18    00FFF4                      ORG     0FFF4h
     19    00FFF4 ....                 DC16    default_int
     20    00FFF2                      ORG     0FFF2h
     21    00FFF2 ....                 DC16    default_int
     22    00FFF0                      ORG     0FFF0h
     23    00FFF0 ....                 DC16    default_int
     24    00FFEE                      ORG     0FFEEh
     25    00FFEE ....                 DC16    default_int
     26    00FFEA                      ORG     0FFEAh
     27    00FFEA ....                 DC16    default_int
     28    00FFE6                      ORG     0FFE6h
     29    00FFE6 ....                 DC16    default_int
     30    00FFE4                      ORG     0FFE4h
     31    00FFE4 ....                 DC16    default_int
     32    00FFE2                      ORG     0FFE2h
     33    00FFE2 ....                 DC16    default_int
     34    00FFE0                      ORG     0FFE0h
     35    00FFE0 ....                 DC16    default_int
     36    00FFE2                      
     37    00FFE8                      ORG     0FFE8h
     38    00FFE8 ....                 DC16    IO1_interrupt
     39    00FFEA                      
     40    00FFEC                      ORG     0FFECh
     41    00FFEC ....                 DC16    timer_A_int
     42    00FFEE                      
     43    00FFF8                      ORG     0FFF8h
     44    00FFF8 ....                 DC16    timer_B_int
     45    00FFFA                      
     46    000000                      RSEG    CSTACK        ; pre-declaration
  of segment
     47    000000                      RSEG    CODE          ; place program in
  'CODE' segment
     48    000000              
     49    000000 3140....     init:   MOV     #SFE(CSTACK), SP        ; set up
                                                            stack
     50    000004              
     51    000004 0343         main:   NOP                   ; main program
     52    000006 B240805A2001         MOV.W   #WDTPW+WDTHOLD,&WDTCTL  ; Stop
                                                                        watchdo
                                                                       g
                                                                        timer
     53    00000C                        
     54    00000C                      
     55    00000C                      ; b0 - g0 - przycisk ladowania
     56    00000C                      ; b1 - g1 - przycisk zliczania w
                                dol
     57    00000C F0D00300....         BIS.B #003h, P1IES    ; ustaw edge
                                                              select na H->L
                                                              dla b0,
                                                              b1
     58    000012 F0D00300....         BIS.B #003h, P1IE     ; wlacz przerwanie
                                                              dla b0,
                                                              b1
     59    000018                      
     60    000018 F0D08000....         BIS.B #080h, P1DIR    ; ustaw b7 jako
                                                              bit wyjsciowy
     61    00001E                                            ; (dioda
                                bledu)
     62    00001E F0D08000....         BIS.B #080h, P1OUT    ; gasi diode
                                                              bledu
     63    000024                      
     64    000024 F0D3....             BIS.B #0FFh, P6DIR    ; ustaw P6 jako
                                                              port wyjsciowy
     65    000028                      
     66    000028                      ; przygotuj licznik timer A
     67    000028                      ; licznik A ma liczyc w trybie UP od 0
                                do wartosci TACCR0
     68    000028                      ; przerwanie TACCR0 wykorzystywane jest
                                przez obsluge
     69    000028                      ; eliminacji drgan
     70    000028 B0D00001....         BIS #0100h, TACTL     ; ustaw zegar
                                                              timera na
                                                              ACLK
     71    00002E B0400500....         MOV #0005h, TACCR0    ; ustaw 5 jako
                                                              wartosc do ktorej
                                                              
     72    000034                                            ; liczy timer
     73    000034 B0D01000....         BIS #0010h, TACCTL0   ; wlacz przerwania
                                                              CCIFG0
     74    00003A                      
     75    00003A                      ; przygotuj licznik timer B w trybie
                                continous
     76    00003A B0405802....         MOV #258h ,TBCCR1     ; wartosc do
                                                              liczenia przy
                                                              odswiezaniu
     77    000040                                            ; 2ms -> 600 ->
                                258 
     78    000040 B0403075....         MOV #7530h ,TBCCR2    ; wartosc do
                                                              liczenia przy
                                                              pomiarze
                                                              czasu
     79    000046                                            ; 1 sekunda->
                                30000 -> 7530h
     80    000046 0943                 CLR R9                ; zerowanie sekund
                                                              i minut
     81    000048 0843                 CLR R8                ; zerowanie
                                                              godzin
     82    00004A B0D02201....         BIS #0122h,TBCTL      ; wlacz przerwania
     83    000050                                            ; ustaw zegar
                                timera na ACLK
     84    000050                                            ; wystartuj
                                liczenie
     85    000050 3040....             BR #init_registers    ; przeskocz
                                                              procedury obslugi
                                                              przerwan
     86    000054                      
     87    000054                      ; procedury obslugi przerwan
     88    000054              IO1_interrupt:
     89    000054 D0B3....             BIT.B #001h, P1IFG    ; g0 ?
     90    000058 0124                 JZ IO1_checkg1
     91    00005A 1FD3                 BIS #0001h, R15       ; ustaw znacznik
                                                              g0
     92    00005C              IO1_checkg1:
     93    00005C E0B3....             BIT.B #002h, P1IFG    ; g1 ?
     94    000060 0124                 JZ IO1_clear
     95    000062 2FD3                 BIS #0002h, R15       ; ustaw znacznik
                                                              g1
     96    000064              IO1_clear:
     97    000064 F0C3....             BIC.B #0FFh, P1IFG    ; czysc znaczniki
                                                              przerwan
     98    000068 0612                 PUSH R6
     99    00006A 16410200             MOV 2(SP), R6
    100    00006E 36C01000             BIC #CPUOFF, R6       ; zmodyfikuj
                                                              lezace na stosie
                                                              SR
    101    000072 81460200             MOV R6, 2(SP)         ; aby obudzic
                                                              procesor
    102    000076 3641                 POP R6
    103    000078 0013                 RETI
    104    00007A                      
    105    00007A              timer_A_int:
    106    00007A 2FD2                 BIS #0004h, R15       ; ustaw znacznik
                                                              timer_A_TACCR0
    107    00007C                      ;BIC #0001h, TACTL
    108    00007C 0612                 PUSH R6
    109    00007E 16410200             MOV 2(SP), R6
    110    000082 36C01000             BIC #CPUOFF, R6       ; zmodyfikuj
                                                              lezace na stosie
                                                              SR
    111    000086 81460200             MOV R6, 2(SP)         ; aby obudzic
                                                              procesor
    112    00008A 3641                 POP R6
    113    00008C 0013                 RETI
    114    00008E              
    115    00008E              timer_B_int:
    116    00008E              
    117    00008E 10521E01             ADD &TBIV,PC          ; Add offset to
                                                              Jump table
    118    000092 0013                 RETI                  ; Vector 0: No
                                                              interrupt
                                                              
    119    000094 0A3C                 JMP CCIFG_1_HND       ; Vector 2: Module
                                                              1 
    120    000096 053C                 JMP CCIFG_2_HND       ; Vector 4: Module
                                                              2 
    121    000098 0013                 RETI                  ; Vector 6: Module
                                                              3
    122    00009A 0013                 RETI                  ; Vector 8: Module
                                                              4
    123    00009C 0013                 RETI                  ; Vector 10:
                                                              Module 5
    124    00009E 0013                 RETI                  ; Vector 12:
                                                              Module 6
    125    0000A0                      
    126    0000A0              TBIFG_HND:                    ; Vector 14: TIMOV
                                Flag
    127    0000A0                                            ; Task starts
                                here
    128    0000A0 0013                 RETI 
    129    0000A2              CCIFG_2_HND:                  ; Vector 4: Module
                                2
    130    0000A2                                            ; odswiezanie
                                
    131    0000A2                                                  
    132    0000A2                      ;TODO odswiezanie
    133    0000A2 B0505802....         ADD #258h,TBCCR2      ; ustawienie
                                                              nowego punktu do
                                                              liczenia
    134    0000A8 F23F                 JMP timer_B_int       ; sprawdza czy nie
                                                              ma innego
                                                              przerwania do
                                                              obsluzenia
    135    0000AA              
    136    0000AA              CCIFG_1_HND:                  ; Vector 2: Module
                                1
    137    0000AA 0712                 PUSH R7               ; liczenie
                                                              czasu
    138    0000AC 1953                 INC R9
    139    0000AE 09A3                 DADC R9
    140    0000B0 3740FF00             MOV #0ffh,R7
    141    0000B4 07F9                 AND R9,R7
    142    0000B6 37906000             CMP #0060h,R7         ;sprawdza czy juz
                                                              minelo 60s
    143    0000BA 0520                 JNE Minuty
    144    0000BC 39C0FF00             BIC #000ffh,R9
    145    0000C0 39500001             ADD #0100h,R9
    146    0000C4 09A3                 DADC R9
    147    0000C6              Minuty:
    148    0000C6 374000FF             MOV #0FF00h,R7
    149    0000CA 07F9                 AND R9,R7
    150    0000CC 37900060             CMP #6000h, R7        ; sprawdza czy juz
                                                              minelo 60
                                                              minut
    151    0000D0 0D20                 JNE RETURN
    152    0000D2 39C000FF             BIC #0ff00h,R9
    153    0000D6 1853                 INC R8
    154    0000D8 08A3                 DADC R8
    155    0000DA 38902400             CMP #024h,R8
    156    0000DE 0620                 JNE RETURN
    157    0000E0 0843                 MOV #00h,R8           ;przekrec licznik
                                                              od poczatku
    158    0000E2 B0503075....         ADD #7530h,TBCCR1     ; ustawienie
                                                              nowego punktu do
                                                              liczenia
    159    0000E8 3741                 POP R7
    160    0000EA D13F                 JMP timer_B_int       ; sprawdza czy nie
                                                              ma innego
                                                              przerwania do
                                                              obsluzenia
    161    0000EC 3741         RETURN: POP R7
    162    0000EE 0013                 RETI
    163    0000F0              default_int:
    164    0000F0 F0C08000....         BIC.B #080h, P1OUT    ; zapala diode
                                                              bledu
    165    0000F6 0013                 RETI
    166    0000F8                      
    167    0000F8              init_registers:
    168    0000F8              
    169    0000F8 0543                 CLR R5
    170    0000FA 0643                 CLR R6
    171    0000FC 0A43                 CLR R10
    172    0000FE 0B43                 CLR R11
    173    000100 0C43                 CLR R12
    174    000102 0D43                 CLR R13
    175    000104 0F43                 CLR R15 
    176    000106                      
    177    000106              app:        
    178    000106                      ; R4  - rejestr obliczen tymczasowych
    179    000106                      ; R5  - stan ukladu w kontekscie obslugi
                                g0
    180    000106                      ;       (na najmniej znaczacych 2och
                                bitach)
    181    000106                      ; R6  - stan ukladu w kontekscie obslugi
                                g1
    182    000106                      ;       (na najmniej znaczacych 2och
                                bitach)
    183    000106                      ; R8  - zegar 8 bit na godzine
                                1-23
    184    000106                      ; R9  - zegar 8 bit na sekundy + 8bit na
                                minuty
    185    000106                      ; R10 - g0::zliczanie cykli eliminacji
                                drgan, max 32 (20h)
    186    000106                      ; R11 - g0::zliczanie wartosci
                                poszukiwanej w eliminacji drgan
    187    000106                      ;       (ile razy pod rzad sie
                                pojawila), max 4
    188    000106                      ; R12 - g1::zliczanie cykli eliminacji
                                drgan, j.w.
    189    000106                      ; R13 - g1::zliczanie wartosci
                                poszukiwanej w eliminacji drgan
    190    000106                      ;       j.w.
    191    000106                      ; R14 - rejestr obliczen tymczasowych
                                
    192    000106                      ;     
    193    000106                      ; R15 - znaczniki uzywane przez
                                przerwania i aplikacje
    194    000106                      ;       b3: 1 => wyswietlanie mm:ss
    195    000106                      ;           0 => wyswietlanie hh:mm
    196    000106                      ;       b2: nastapilo przerwanie timera
                                A
    197    000106                      ;       b1: wcisnieto g1
    198    000106                      ;       b0: wcisnieto g0
    199    000106                      
    200    000106                      
    201    000106                      ;----------- automat stanowy g0
                                -----------
    202    000106                      ; sprawdz w jakim stanie znajduje sie
                                uklad
    203    000106              check000:
    204    000106 0593                 CMP #0000h, R5      ; stan 000
    205    000108 0A20                 JNE check001
    206    00010A 1FB3                 BIT #0001h, R15     ; g0 ?
    207    00010C 5224                 JZ autom_g1
    208    00010E D0C3....             BIC.B #001h, P1IE   ; wylacz przerwanie
                                                            g0
    209    000112 1543                 MOV #0001h, R5      ; stan := 001
                                                            
    210    000114 B0D01000....         BIS #0010h, TACTL   ; Timer A start UP
                                                            to TACCR0
    211    00011A 3040....             BR #autom_g1        ; przejdz do obslugi
                                                            g1
    212    00011E                      
    213    00011E                      ;--------------- obsluga g0 ------------
                               ---
    214    00011E              check001:
    215    00011E 1593                 CMP #0001h, R5      ; stan 001
    216    000120 1F20                 JNE check011
    217    000122 2FB2         do001:  BIT #0004h, R15     ; przerwanie
                                                            timer_A
    218    000124 4624                 JZ autom_g1
    219    000126 1B53                 INC R11             ; licznik_zer++
    220    000128 1A53                 INC R10             ; licznik_cykli++
    221    00012A D0B3....             BIT.B #001h, P1IN   ; g0 != 0 ?
    222    00012E 0124                 JZ noclr001
    223    000130 0B43                 CLR R11                        
                                                                        
    224    000132              noclr001:
    225    000132 2B92                 CMP #0004h, R11                
                                                                        
    226    000134 0A20                 JNE timeout001
    227    000136                      ; eliminacja drgan zakonczona
    228    000136 3FB2                 BIT #0008h, R15
    229    000138 3FD2                 BIS #0008h, R15     ; ustaw mm:ss
    230    00013A 0124                 JZ mmssset001
    231    00013C 3FC2                 BIC #0008h, R15     ; ustaw hh:mm
    232    00013E              mmssset001:
    233    00013E 35400300             MOV #0003h, R5      ; stan := 011
    234    000142 0B43                 CLR R11             ; czysc liczniki
                                                            eliminacji
                                                            drgan
    235    000144 0A43                 CLR R10
    236    000146 3040....             BR #autom_g1
    237    00014A              timeout001:
    238    00014A 3A902000             CMP #0020h, R10
    239    00014E 3120                 JNE autom_g1
    240    000150 0543                 MOV #0000h, R5      ; stan := 000
    241    000152 0B43                 CLR R11             ; czysc liczniki
                                                            eliminacji
                                                            drgan
    242    000154 0A43                 CLR R10
    243    000156 1FC3                 BIC #0001h, R15     ; czysc informacje o
                                                            obsludze g0
    244    000158 D0D3....             BIS.B #001h, P1IE   ; wlacz przerwanie
                                                            g0
    245    00015C 3040....             BR #autom_g1
    246    000160                      
    247    000160              check011:
    248    000160 35900300             CMP #0003h, R5      ; stan 011
    249    000164 0820                 JNE check010
    250    000166 2FB2                 BIT #0004h, R15     ; przerwanie
                                                            timer_A
    251    000168 2424                 JZ autom_g1
    252    00016A D0B3....             BIT.B #001h, P1IN   ; g0 != 0 ?
    253    00016E 2124                 JZ autom_g1
    254    000170 2543                 MOV #0002h, R5      ; stan := 010
    255    000172 3040....             BR #autom_g1
    256    000176                      
    257    000176              check010: 
    258    000176                      ;CMP #0002h, R5     ; stan 010, nie
                                musimy sprawdzac
    259    000176 2A20                 JNE check101
    260    000178 2FB2                 BIT #0004h, R15     ; przerwanie
                                                            timer_A
    261    00017A 1B24                 JZ autom_g1
    262    00017C 1B53                 INC R11             ; licznik_zer++
    263    00017E 1A53                 INC R10             ; licznik_cykli++
    264    000180 D0B3....             BIT.B #001h, P1IN   ; g0 != 0 ?
    265    000184 0120                 JNZ noclr010
    266    000186 0B43                 CLR R11        
    267    000188              noclr010:
    268    000188 2B92                 CMP #0004h, R11                
                                                                        
    269    00018A 0A20                 JNE timeout010
    270    00018C                      ; eliminacja drgan zakonczona
    271    00018C 0543                 MOV #0000h, R5      ; stan := 000
    272    00018E 0B43                 CLR R11             ; czysc liczniki
                                                            eliminacji
                                                            drgan
    273    000190 0A43                 CLR R10
    274    000192 1FC3                 BIC #0001h, R15     ; czysc informacje o
                                                            obsludze g0
    275    000194 D0C3....             BIC.B #001h, P1IFG  ; czysc informacje o
                                                            przerwaniach
                                                            g0
    276    000198 D0D3....             BIS.B #001h, P1IE   ; wlacz przerwania
                                                            g0
    277    00019C 3040....             BR #autom_g1
    278    0001A0              timeout010:
    279    0001A0 3A902000             CMP #0020h, R10
    280    0001A4 0620                 JNE autom_g1
    281    0001A6 35400300             MOV #0003h, R5      ; stan := 011
    282    0001AA 0B43                 CLR R11             ; czysc liczniki
                                                            eliminacji
                                                            drgan
    283    0001AC 0A43                 CLR R10
    284    0001AE 3040....             BR #autom_g1
    285    0001B2                      
    286    0001B2              autom_g1:
    287    0001B2                      ;----------- automat stanowy g1
                                -----------
    288    0001B2 0693                 CMP #0000h, R6      ; stan 100 (dla
                                                            porzadku 000h)
    289    0001B4 0B20                 JNE check101
    290    0001B6 2FB3                 BIT #0002h, R15     ; g1 ?
    291    0001B8 FC27                 JZ autom_g1
    292    0001BA E0C3....             BIC.B #002h, P1IE   ; wylacz przerwanie
                                                            g1
    293    0001BE 36400500             MOV #0005h, R6      ; stan := 101
    294    0001C2 B0D01000....         BIS #0010h, TACTL   ; Timer A start UP
                                                            to TACCR0
    295    0001C8 3040....             BR #sleep
    296    0001CC                      
    297    0001CC                      ;--------------- obsluga g1 ------------
                               ---
    298    0001CC              check101:        
    299    0001CC 36900500             CMP #0005h, R6      ; stan 101
    300    0001D0 4120                 JNE check111
    301    0001D2 2FB2                 BIT #0004h, R15     ; przerwanie
                                                            timer_A
    302    0001D4 6824                 JZ sleep
    303    0001D6 1D53                 INC R13             ; licznik_zer++
    304    0001D8 1C53                 INC R12             ; licznik_cykli++
    305    0001DA E0B3....             BIT.B #002h, P1IN   ; g1 != 0 ?
    306    0001DE 0124                 JZ noclr101
    307    0001E0 0D43                 CLR R13        
    308    0001E2              noclr101:
    309    0001E2 2D92                 CMP #0004h, R13                
                                                                        
    310    0001E4 2A20                 JNE timeout101
    311    0001E6                      
    312    0001E6 0443                 CLR R4
    313    0001E8 5440....             MOV.B P4IN, R4      ; laduj mm do
                                                            R4
    314    0001EC 34903C00             CMP #60, R4
    315    0001F0 0238                 JL nommchange101
    316    0001F2 34403B00             MOV #59, R4
    317    0001F6              nommchange101:
    318    0001F6 0454                 RLA R4
    319    0001F8 0454                 RLA R4
    320    0001FA 0454                 RLA R4
    321    0001FC 0454                 RLA R4              ; R4 == [mm00]
    322    0001FE                      
    323    0001FE 0E43                 CLR R14
    324    000200 5E40....             MOV.B P3IN, R14     ; laduj hh do
                                                            R14
    325    000204 3E901800             CMP #24, R14
    326    000208 0238                 JL nohhchange101
    327    00020A 3E401700             MOV #23, R14        ; R14 = [00hh]
    328    00020E              nohhchange101:
    329    00020E              
    330    00020E B0C01100....         BIC #0011h, TBCCTL2 ; wylacz przerwania
                                                            zliczania
                                                            zegara
    331    000214 B0C03000....         BIC #0030h, TBCTL   ; zastopuj
                                                            timerB
    332    00021A 8043....             CLR TBR             ; czysc timerB
    333    00021E 084E                 MOV R14, R8         ; ustaw hh
    334    000220 0944                 MOV R4, R9          ; ustaw mmss
    335    000222 B0D02000....         BIS #0020h, TBCTL   ; wlacz timerB
    336    000228 B0D01000....         BIS #0010h, TBCCTL2 ; wlacz przerwania
                                                            zliczania
                                                            zegara
    337    00022E              
    338    00022E 36400700             MOV #0007h, R6      ; stan := 111
    339    000232 0D43                 CLR R13             ; czysc liczniki
                                                            eliminacji
                                                            drgan
    340    000234 0C43                 CLR R12
    341    000236 3040....             BR #sleep
    342    00023A              timeout101:
    343    00023A 3C902000             CMP #0020h, R12
    344    00023E 3320                 JNE sleep
    345    000240 0643                 MOV #0000h, R6      ; stan := 100
    346    000242 0D43                 CLR R13             ; czysc liczniki
                                                            eliminacji
                                                            drgan
    347    000244 0C43                 CLR R12
    348    000246 2FC3                 BIC #0002h, R15     ; czysc informacje o
                                                            obsludze g1
    349    000248 E0C3....             BIC.B #002h, P1IFG  ; czysc informacje o
                                                            przerwaniu
                                                            g1
    350    00024C E0D3....             BIS.B #002h, P1IE   ; wlacz przerwania
                                                            g1
    351    000250 3040....             BR #sleep
    352    000254              
    353    000254              check111:
    354    000254 36900700             CMP #0007h, R6      ; stan 111
    355    000258 0920                 JNE check110
    356    00025A 2FB2                 BIT #0004h, R15     ; przerwanie
                                                            timer_A
    357    00025C 2424                 JZ sleep
    358    00025E E0B3....             BIT.B #002h, P1IN   ; g1 != 0 ?
    359    000262 2124                 JZ sleep
    360    000264 36400600             MOV #0006h, R6      ; stan := 110
    361    000268 3040....             BR #sleep
    362    00026C              
    363    00026C              check110: 
    364    00026C                      ;CMP #0006h, R6     ; stan 110, nie
                                musimy sprawdzac
    365    00026C 2FB2                 BIT #0004h, R15     ; przerwanie
                                                            timer_A
    366    00026E 1B24                 JZ sleep
    367    000270 1D53                 INC R13             ; licznik_zer++
    368    000272 1C53                 INC R12             ; licznik_cykli++
    369    000274 E0B3....             BIT.B #002h, P1IN   ; g1 != 0 ?
    370    000278 0120                 JNZ noclr110
    371    00027A 0D43                 CLR R13        
    372    00027C              noclr110:
    373    00027C 2D92                 CMP #0004h, R13                
                                                                        
    374    00027E 0A20                 JNE timeout110
    375    000280                      ; eliminacja drgan zakonczona
    376    000280 0643                 MOV #0000h, R6      ; stan := 000
    377    000282 0D43                 CLR R13             ; czysc liczniki
                                                            eliminacji
                                                            drgan
    378    000284 0C43                 CLR R12
    379    000286 2FC3                 BIC #0002h, R15     ; czysc informacje o
                                                            obsludze g1
    380    000288 E0C3....             BIC.B #002h, P1IFG  ; czysc informacje o
                                                            przerwaniu
                                                            g1
    381    00028C E0D3....             BIS.B #002h, P1IE   ; wlacz przerwanie
                                                            g1
    382    000290 3040....             BR #sleep
    383    000294              timeout110:
    384    000294 3C902000             CMP #0020h, R12
    385    000298 0620                 JNE sleep
    386    00029A 36400700             MOV #0007h, R6      ; stan := 111
    387    00029E 0D43                 CLR R13             ; czysc liczniki
                                                            eliminacji
                                                            drgan
    388    0002A0 0C43                 CLR R12
    389    0002A2 3040....             BR #sleep
    390    0002A6                     
    391    0002A6              sleep:
    392    0002A6 2FC2                 BIC #0004h, R15     ; wyczyszczenie info
                                                            o przerwaniu
    393    0002A8                                          ;  timerA jesli
                                bylo
    394    0002A8 3FB00300             BIT #0003h, R15     ; czy trwa obsluga
                                                            g0 lub g1?
    395    0002AC 0320                 JNZ enter_lpm       ; jesli tak, to
                                                            spij
    396    0002AE B0C01000....         BIC #0010h, TACTL   ; Timer A stop UP to
                                                            TACCR0
    397    0002B4               
    398    0002B4              enter_lpm:        
    399    0002B4 32D01800             BIS #GIE+CPUOFF, SR ; przejscie do
                                                            LPM1
    400    0002B8 3040....             BR #app             ; skok na poczatek
                                                            czesci aplikacyjnej
    401    0002BC              
    402    0002BC                      END
##############################
#          CRC:93B8          #
#        Errors:   0         #
#        Warnings: 0         #
#         Bytes: 732         #
##############################



